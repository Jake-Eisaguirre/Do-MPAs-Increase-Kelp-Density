---
title: "Untitled"
author: "Jake Eisaguirre"
date: "11/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(patchwork)
```

#read in and clean data
```{r}

raw_data <- read_csv(here("MLPA_swath_site_means.csv"))


initial_fig_data <- raw_data %>% 
  filter(campus == "UCSB") %>% 
  select(c("survey_year", "site", "latitude", "longitude", "site_status", 
           "den_STRPURAD", "den_MESFRAAD", "den_MACPYRAD", "den_MACSTIPES")) %>% 
  group_by(survey_year, site_status) %>% 
  mutate(mean_purp = mean(den_STRPURAD),
            mean_red = mean(den_MESFRAAD),
         mean_stipe = mean(den_MACSTIPES),
         mean_mac = mean(den_MACPYRAD)) %>% 
  ungroup() %>% 
  separate(col = site, into = c('island', 'site'), sep = '_') %>% 
  filter(island %in% c("ANACAPA", "SCI", "SRI", "SMI"))

```

```{r}

a <- ggplot(data = initial_fig_data) +
  geom_line(aes(x = survey_year, y = mean_purp, color = site_status)) +
  theme_classic() +
  xlab("Year")+
  ylab("Mean Purple Urchins")

b <- ggplot(data = initial_fig_data) +
  geom_line(aes(x = survey_year, y = mean_red, color = site_status)) +
  theme_classic()+
  xlab("Year")+
  ylab("Mean Red Urchins")

c <- ggplot(data = initial_fig_data) +
  geom_line(aes(x = survey_year, y = mean_stipe, color = site_status)) +
  theme_classic()+
  xlab("Year")+
  ylab("Mean Kelp")


a/b/c



```

```{r}

m <- lm(den_STRPURAD ~ mpa_status, data = initial_fig_data)
summary(m)

k <- lm(den_MACSTIPES ~ den_STRPURAD + mpa_status + island + den_STRPURAD:mpa_status + den_STRPURAD:island, 
        data = initial_fig_data)
summary(k)

```
